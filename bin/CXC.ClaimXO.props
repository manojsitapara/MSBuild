<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Run">

  <PropertyGroup>
    <Environment>PayFlexProduction</Environment>
    <SVNSourceURL>https://svn.cxcnetwork.com/svn/CXCcore/branches/TestBuild</SVNSourceURL>
    <SVNTagURL>https://svn.cxcnetwork.com/svn/CXCcore/tags</SVNTagURL>
    <SvnUsername></SvnUsername>
    <SvnPassword></SvnPassword>
  </PropertyGroup>


  <Import Project="CXC.ClaimXO.QA.props" Condition="$(Environment) == 'QA'"/>
  <Import Project="CXC.ClaimXO.Production.props" Condition="$(Environment) == 'Production'"/>
  <Import Project="CXC.ClaimXO.PayFlexProduction.props" Condition="$(Environment) == 'PayFlexProduction'"/>


  <!--DO NOT MODIFY FOLLOWING PROPERTY GROUP-->
  <PropertyGroup>

    <PreviousAssemblyVersionNumber></PreviousAssemblyVersionNumber>
    <NewAssemblyVersion></NewAssemblyVersion>
    <DbDeployScriptFolderName>DbDeployScript</DbDeployScriptFolderName>
    <DbDeployScriptInputFolderName>$(DbDeployScriptFolderName)\Input</DbDeployScriptInputFolderName>
    <DbDeployScriptOutputFolderName>$(DbDeployScriptFolderName)\Output</DbDeployScriptOutputFolderName>
    <AppFolderName>App</AppFolderName>
    <CommandAndSqlFilesFolderName>Workflow</CommandAndSqlFilesFolderName>

    <CurrentTargetName></CurrentTargetName>

    <CurrentDateTime>$([System.DateTime]::Now.ToString(yyyyMMdd_hh_mm_ss))</CurrentDateTime>
    <CurrentDate>$([System.DateTime]::Now.ToString(yyyyMMdd))</CurrentDate>


    <!-- Specify the path of source code -->
    <SourceDir>$(RootDir)\Source</SourceDir>
    <!-- Specify the path to save build code -->
    <BuildDir>$(RootDir)\Staging</BuildDir>
    <!-- Specify the path to copy build code on server -->
    <DestinationDir>$(RootDir)\Destination</DestinationDir>



    <!-- Specify the path to backup of source code -->
    <SourceBackupDir>$(RootDir)\Backup\Source</SourceBackupDir>
    <!-- Specify the path to backup of deployment code -->
    <DeploymentBackupDir>$(RootDir)\Backup\Deployment</DeploymentBackupDir>
    <!-- Specify the path to backup of database -->
    <DatabaseBackupDir>$(RootDir)\Backup\Database</DatabaseBackupDir>
    <!-- Specify the path to back up build code on server -->
    <TargetBackupDir>$(RootDir)\Backup\Destination</TargetBackupDir>


    <!--Specify the path for deployment directory (i.e. ready to run code) -->
    <DeploymentDir>$(RootDir)\Deployment</DeploymentDir>

    <TempDir>$(RootDir)\Staging\temp</TempDir>
    <TempAssemblyFile>$(TempDir)\AssemblyVersionNumber.txt</TempAssemblyFile>
    <TempDbDeployFile>$(TempDir)\dbDeployFileName.txt</TempDbDeployFile>

    <BuildDirForApp>$(BuildDir)\$(AppFolderName)</BuildDirForApp>
    <BuildDirForCommandAndSqlFiles>$(BuildDir)\$(CommandAndSqlFilesFolderName)</BuildDirForCommandAndSqlFiles>
    <BuildDirForDbDeploy>$(BuildDir)\$(DbDeployScriptInputFolderName)</BuildDirForDbDeploy>
    <BuildDirForDbDeployOutput>$(BuildDir)\$(DbDeployScriptOutputFolderName)</BuildDirForDbDeployOutput>

    <DeploymentDirForApp>$(DeploymentDir)\$(AppFolderName)</DeploymentDirForApp>

    <DeploymentDirForDbDeploy>$(DeploymentDir)\$(DbDeployScriptFolderName)</DeploymentDirForDbDeploy>


    <CXCCoreSchemaChangesSqlDir>$(BuildDirForDbDeploy)\CXCCore\1.CXCCore_SchemaChanges</CXCCoreSchemaChangesSqlDir>
    <CXCCoreMetaChangesSqlDir>$(BuildDirForDbDeploy)\CXCCore\2.CXCCore_Meta</CXCCoreMetaChangesSqlDir>


    <!--TODO: Make group of related property together-->
    <XmlPreprocessorCleanFile>true</XmlPreprocessorCleanFile>
    <XmlPreprocessorValidateFile>true</XmlPreprocessorValidateFile>

    <!-- This setting is for command file transformation -->
    <VariableColumnNameForCommandFile>Environment Name</VariableColumnNameForCommandFile>


    <DatabaseConnectionString Condition="$(IsSqlWindowsAuthentication)=='true'">Server=$(SqlServerName);Initial Catalog=$(dbDeployDBName);Integrated Security=SSPI</DatabaseConnectionString>
    <DatabaseConnectionString Condition="$(IsSqlWindowsAuthentication)=='false'">Server=$(SqlServerName);Initial Catalog=$(dbDeployDBName);User Id=$(SqlServerUserName);Password=$(SqlServerPassword)</DatabaseConnectionString>


  </PropertyGroup>




  <ItemGroup>

    <SolutionName Include="$(SourceDir)\TPA\GDI\CXCGDI.sln"  Condition="$(BuildGDI)=='true' ">
      <TPAName>GDI</TPAName>

      <MetaChangeScriptDir>$(SourceDir)\TPA\GDI\GDI\Build\MetaChanges</MetaChangeScriptDir>
      <DataChangeScriptDir>$(SourceDir)\TPA\GDI\GDI\Build\DataChanges</DataChangeScriptDir>
      <ScriptDir>$(SourceDir)\TPA\PrimePay\CXCPrimePay\Build\</ScriptDir>
      <BuildDirForMetaSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\GDI\1.GDI_MetaChanges</BuildDirForMetaSqlScript>
      <BuildDirForDataSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\GDI\2.GDI_DataChanges</BuildDirForDataSqlScript>

      <CommandAndSqlFilesDir>$(SourceDir)\CXC\Scripts</CommandAndSqlFilesDir>
      <CommandAndSqlFilesBuildDir>$(BuildDirForCommandAndSqlFiles)\Common</CommandAndSqlFilesBuildDir>
      <CommandAndSqlFilesDeploymentDir>$(DeploymentDirForApp)</CommandAndSqlFilesDeploymentDir>

      <StateParamXmlFileDir>$(BuildDirForApp)\GDI\config\StateParams.xml</StateParamXmlFileDir>

    </SolutionName>


    <SolutionName Include="$(SourceDir)\TPA\PrimePay\CXCPrimePay.sln"  Condition="$(BuildPrimePay)=='true' ">
      <TPAName>PrimePay</TPAName>

      <MetaChangeScriptDir>$(SourceDir)\TPA\PrimePay\CXCPrimePay\Build\MetaChanges</MetaChangeScriptDir>
      <DataChangeScriptDir>$(SourceDir)\TPA\PrimePay\CXCPrimePay\Build\DataChanges</DataChangeScriptDir>
      <ScriptDir>$(SourceDir)\TPA\PrimePay\CXCPrimePay\Build\</ScriptDir>
      <BuildDirForMetaSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\PrimePay\1.PrimePay_MetaChanges</BuildDirForMetaSqlScript>
      <BuildDirForDataSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\PrimePay\2.PrimePay_DataChanges</BuildDirForDataSqlScript>

      <CommandAndSqlFilesDir>$(SourceDir)\TPA\PrimePay\CXCPrimePay\Scripts</CommandAndSqlFilesDir>
      <CommandAndSqlFilesBuildDir>$(BuildDirForCommandAndSqlFiles)\PrimePay</CommandAndSqlFilesBuildDir>
      <CommandAndSqlFilesDeploymentDir>$(DeploymentDirForApp)</CommandAndSqlFilesDeploymentDir>

      <StateParamXmlFileDir>$(BuildDirForApp)\PrimePay\config\StateParams.xml</StateParamXmlFileDir>

    </SolutionName>

    <SolutionName Include="$(SourceDir)\TPA\PayFlex\CXCPayFlex.sln"  Condition="$(BuildPayFlex)=='true' " >
      <TPAName>PayFlex</TPAName>

      <MetaChangeScriptDir>$(SourceDir)\TPA\PayFlex\PayFlex\Build\MetaChanges</MetaChangeScriptDir>
      <DataChangeScriptDir>$(SourceDir)\TPA\PayFlex\PayFlex\Build\DataChanges</DataChangeScriptDir>
      <BuildDirForMetaSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\PayFlex\1.PayFlex_MetaChanges</BuildDirForMetaSqlScript>
      <BuildDirForDataSqlScript>$(BuildDir)\$(DbDeployScriptInputFolderName)\PayFlex\2.PayFlex_DataChanges</BuildDirForDataSqlScript>

      <CommandAndSqlFilesDir>$(SourceDir)\TPA\PayFlex\PayFlex\Scripts</CommandAndSqlFilesDir>
      <CommandAndSqlFilesBuildDir>$(BuildDirForCommandAndSqlFiles)\PayFlex</CommandAndSqlFilesBuildDir>
      <CommandAndSqlFilesDeploymentDir>$(DeploymentDirForApp)</CommandAndSqlFilesDeploymentDir>

      <StateParamXmlFileDir>$(BuildDirForApp)\PayFlex\config\StateParams.xml</StateParamXmlFileDir>
    </SolutionName>

  </ItemGroup>

  
  <ItemGroup>
    <CommandFileName Include="$(BuildDirForCommandAndSqlFiles)\PayFlex\PayFlex_SetEnv.cmd"  Condition="$(BuildPayFlex)=='true' " />
    <CommandFileName Include="$(BuildDirForCommandAndSqlFiles)\PayFlex\PayFlexFTP_SetEnv.cmd"  Condition="$(BuildPayFlex)=='true' " />
  </ItemGroup>
  
  
</Project>
